(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[414],{4880:function(e,t,r){Promise.resolve().then(r.t.bind(r,2972,23)),Promise.resolve().then(r.bind(r,1610))},3145:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(8461),s=r.n(a)},8461:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return c},getImageProps:function(){return i}});let a=r(7043),s=r(5346),o=r(5878),n=a._(r(5084));function i(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=o.Image},1610:function(e,t,r){"use strict";var a=r(7437),s=r(7648),o=r(9376),n=r(9064),i=r(7208),c=r(2265),d=r(9663),l=r(9636);t.default=e=>{let{onClose:t,onSwitchToSignIn:r}=e,u=(0,o.useRouter)(),[h,m]=(0,c.useState)(!1),[p,w]=(0,c.useState)({name:"",email:"",password:"",general:""}),[g,f]=(0,c.useState)({name:"",email:"",password:""}),y=e=>{let t=0;return e.length>=8&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/\d/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++,t},b=e=>{switch(e){case 0:case 1:return{text:"Very Weak",color:"text-red-400"};case 2:return{text:"Weak",color:"text-orange-400"};case 3:return{text:"Fair",color:"text-yellow-400"};case 4:return{text:"Good",color:"text-green-400"};case 5:return{text:"Strong",color:"text-green-500"};default:return{text:"",color:""}}},x=e=>e.trim()?e.trim().length<2?"Name must be at least 2 characters":e.trim().length>50?"Name must be less than 50 characters":"":"Name is required",k=e=>e.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"":"Please enter a valid email address":"Email is required",j=e=>e.trim()?e.length<8?"Password must be at least 8 characters":/(?=.*[a-z])/.test(e)?/(?=.*[A-Z])/.test(e)?/(?=.*\d)/.test(e)?"":"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter":"Password is required",v=()=>{let e={name:x(g.name),email:k(g.email),password:j(g.password),general:""};return w(e),!e.name&&!e.email&&!e.password},N=async e=>{if(e.preventDefault(),w({name:"",email:"",password:"",general:""}),v()){m(!0);try{await l.Z.register(g),n.ZP.success("Successfully registered! Redirecting to dashboard..."),m(!1),t&&t(),setTimeout(()=>{u.push("/dashboard")},1e3)}catch(t){m(!1);let e=t.message||"Registration failed";e.toLowerCase().includes("email already exists")||e.toLowerCase().includes("user already exists")||e.toLowerCase().includes("email is already taken")?w(e=>({...e,general:"An account with this email already exists. Please use a different email or try signing in."})):e.toLowerCase().includes("invalid email")?w(e=>({...e,email:"Please enter a valid email address"})):e.toLowerCase().includes("password")&&e.toLowerCase().includes("weak")?w(e=>({...e,password:"Password is too weak. Please choose a stronger password."})):e.toLowerCase().includes("network")||e.toLowerCase().includes("connection")?w(e=>({...e,general:"Network error. Please check your connection and try again."})):w(t=>({...t,general:e})),n.ZP.error(e)}}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-10 text-center mx-auto inline-block max-w-[160px]",children:(0,a.jsx)(i.Z,{})}),(0,a.jsxs)("form",{onSubmit:N,children:[p.general&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-md bg-red-500 bg-opacity-10 border border-red-500 border-opacity-30",children:(0,a.jsx)("p",{className:"text-red-400 text-sm",children:p.general})}),(0,a.jsxs)("div",{className:"mb-[22px]",children:[(0,a.jsx)("input",{type:"text",placeholder:"Full Name",value:g.name,onChange:e=>{f({...g,name:e.target.value}),p.name&&w(e=>({...e,name:""}))},className:"w-full rounded-md border ".concat(p.name?"border-red-500 focus:border-red-500":"border-dark_border border-opacity-60 focus:border-primary"," border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus-visible:shadow-none text-white dark:focus:border-primary")}),p.name&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:p.name})]}),(0,a.jsxs)("div",{className:"mb-[22px]",children:[(0,a.jsx)("input",{type:"email",placeholder:"Email Address",value:g.email,onChange:e=>{f({...g,email:e.target.value}),p.email&&w(e=>({...e,email:""}))},className:"w-full rounded-md border ".concat(p.email?"border-red-500 focus:border-red-500":"border-dark_border border-opacity-60 focus:border-primary"," border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus-visible:shadow-none text-white dark:focus:border-primary")}),p.email&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:p.email})]}),(0,a.jsxs)("div",{className:"mb-[22px]",children:[(0,a.jsx)("input",{type:"password",placeholder:"Password (min 8 chars, include A-Z, a-z, 0-9)",value:g.password,onChange:e=>{f({...g,password:e.target.value}),p.password&&w(e=>({...e,password:""}))},className:"w-full rounded-md border ".concat(p.password?"border-red-500 focus:border-red-500":"border-dark_border border-opacity-60 focus:border-primary"," border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus-visible:shadow-none text-white dark:focus:border-primary")}),g.password&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Strength:"}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(b(y(g.password)).color),children:b(y(g.password)).text})]}),(0,a.jsx)("div",{className:"flex space-x-1 mt-1",children:[1,2,3,4,5].map(e=>(0,a.jsx)("div",{className:"h-1 w-full rounded ".concat(e<=y(g.password)?e<=2?"bg-red-400":e<=3?"bg-yellow-400":"bg-green-400":"bg-gray-600")},e))})]}),p.password&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:p.password})]}),(0,a.jsx)("div",{className:"mb-9",children:(0,a.jsxs)("button",{type:"submit",disabled:h||!g.name||!g.email||!g.password,className:"flex w-full items-center text-18 font-medium justify-center rounded-md bg-primary px-5 py-3 text-darkmode transition duration-300 ease-in-out hover:bg-transparent hover:text-primary border-primary border disabled:opacity-50 disabled:cursor-not-allowed",children:["Sign Up ",h&&(0,a.jsx)(d.Z,{})]})})]}),(0,a.jsxs)("p",{className:"text-body-secondary text-white text-base",children:["Already have an account?",r?(0,a.jsx)("button",{onClick:r,className:"pl-2 text-primary hover:underline bg-transparent border-none cursor-pointer",children:"Sign In"}):(0,a.jsx)(s.default,{href:"/",className:"pl-2 text-primary hover:underline",children:"Sign In"})]})]})}},9663:function(e,t,r){"use strict";var a=r(7437);r(2265),t.Z=()=>(0,a.jsx)("span",{className:"ml-1.5 h-4 w-4 animate-spin rounded-full border-2 border-solid border-white border-t-transparent dark:border-t-transparent"})},7208:function(e,t,r){"use strict";var a=r(7437),s=r(3950),o=r(3145),n=r(7648);t.Z=()=>(0,a.jsx)(n.default,{href:"/",children:(0,a.jsx)(o.default,{src:"".concat((0,s.p)(),"images/logo/logo.png"),alt:"QFS Ledger Logo",width:160,height:50,style:{width:"auto",height:"auto",maxHeight:"50px",objectFit:"contain"},quality:100,priority:!0})})},9636:function(e,t,r){"use strict";let a="".concat("https://www.qfsvaultledger.org","/api");class s{handleApiError(e,t){let r="An unexpected error occurred";throw t.error?r=t.error:t.message?r=t.message:t.detail?r=t.detail:400===e.status?r="Invalid request. Please check your input.":401===e.status?r="Invalid credentials. Please check your email and password.":403===e.status?r="Access denied. Your account may be disabled.":404===e.status?r="User not found. Please check your email or sign up.":409===e.status?r="Email already exists. Please use a different email.":e.status>=500&&(r="Server error. Please try again later."),Error(r)}async register(e){try{let t=await fetch("".concat(a,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),r=await t.json();return t.ok||this.handleApiError(t,r),this.storeTokens(r.tokens),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async login(e){try{let t=await fetch("".concat(a,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),r=await t.json();return t.ok||this.handleApiError(t,r),this.storeTokens(r.tokens),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async getProfile(){let e=await this.authenticatedRequest("".concat(a,"/auth/profile/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get user profile");return t.user}storeTokens(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh)}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}isAuthenticated(){return!!this.getAccessToken()}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token found");let t=await fetch("".concat(a,"/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),r=await t.json();if(!t.ok)throw Error("Failed to refresh token");return localStorage.setItem("access_token",r.access),r.access}async authenticatedRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getAccessToken();if(!r)throw Error("No access token found");let a={Authorization:"Bearer ".concat(r),...t.headers};t.body instanceof FormData||(a["Content-Type"]="application/json");let s=await fetch(e,{...t,headers:a});if(401===s.status)try{r=await this.refreshToken();let a={Authorization:"Bearer ".concat(r),...t.headers};t.body instanceof FormData||(a["Content-Type"]="application/json"),s=await fetch(e,{...t,headers:a})}catch(e){console.warn("Token refresh failed, but keeping user logged in:",e)}return s}async changePassword(e){let t=await this.authenticatedRequest("".concat(a,"/auth/change-password/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:e.currentPassword,new_password:e.newPassword})}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to change password");return r}async submitKYCDocument(e){let t=await this.authenticatedRequest("".concat(a,"/kyc/submit/"),{method:"POST",body:e}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to submit document");return r}async getKYCStatus(){let e=await this.authenticatedRequest("".concat(a,"/kyc/status/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC status");return t}async getAdminKYCList(){let e=await this.authenticatedRequest("".concat(a,"/admin/kyc/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC submissions");return t}async requestPasswordReset(e){try{let t=await fetch("".concat(a,"/auth/forgot-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({email:e})}),r=await t.json();return t.ok||this.handleApiError(t,r),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async resetPassword(e,t){try{let r=await fetch("".concat(a,"/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({token:e,password:t})}),s=await r.json();return r.ok||this.handleApiError(r,s),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async reviewKYCSubmission(e,t,r){let s=await this.authenticatedRequest("".concat(a,"/admin/kyc/").concat(e,"/review/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,notes:r})}),o=await s.json();if(!s.ok)throw Error(o.error||"Failed to review KYC submission");return o}}let o=new s;t.Z=o},3950:function(e,t,r){"use strict";r.d(t,{p:function(){return a}});let a=()=>""}},function(e){e.O(0,[972,279,878,971,117,744],function(){return e(e.s=4880)}),_N_E=e.O()}]);