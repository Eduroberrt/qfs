(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[124],{8742:function(e,t,s){Promise.resolve().then(s.bind(s,4902))},4902:function(e,t,s){"use strict";s.r(t);var r=s(7437),a=s(2265),i=s(9376),n=s(9636),o=s(9064),c=s(7648);t.default=()=>{var e;let[t,s]=(0,a.useState)([]),[l,d]=(0,a.useState)(!0),[h,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[p,f]=(0,a.useState)(""),[w,g]=(0,a.useState)(!1),[j,b]=(0,a.useState)("all"),y=(0,i.useRouter)();(0,a.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=await n.ZP.getAdminKYCList();s(e.submissions)}catch(s){var e,t;o.ZP.error(s.message||"Failed to fetch KYC submissions"),((null===(e=s.message)||void 0===e?void 0:e.includes("permission"))||(null===(t=s.message)||void 0===t?void 0:t.includes("admin")))&&y.push("/dashboard")}finally{d(!1)}},k=async(e,t)=>{u(e);try{await n.ZP.reviewKYCSubmission(e,t,p),o.ZP.success("KYC verification ".concat(t,"d successfully")),await v(),g(!1),x(null),f("")}catch(e){o.ZP.error(e.message||"Failed to ".concat(t," verification"))}finally{u(null)}},N=e=>{x(e),f(e.admin_notes||""),g(!0)},C=e=>{switch(e){case"pending":return"text-yellow-500 bg-yellow-500/10";case"verified":return"text-green-500 bg-green-500/10";case"rejected":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},S=e=>{switch(e){case"pending":return(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})});case"verified":return(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"rejected":return(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}},T=t.filter(e=>"all"===j||e.status===j);return l?(0,r.jsx)("div",{className:"min-h-screen bg-darkmode flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):(0,r.jsxs)("div",{className:"min-h-screen bg-darkmode",children:[(0,r.jsx)("div",{className:"border-b border-section border-opacity-20",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"KYC Verification Admin"}),(0,r.jsx)(c.default,{href:"/dashboard",className:"text-primary hover:text-white transition-colors",children:"← Back to Dashboard"})]})})}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsx)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted text-sm",children:"Total Submissions"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:t.length})]}),(0,r.jsx)("div",{className:"w-12 h-12 bg-primary bg-opacity-20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})}),(0,r.jsx)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted text-sm",children:"Pending Review"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-500",children:t.filter(e=>"pending"===e.status).length})]}),(0,r.jsx)("div",{className:"w-12 h-12 bg-yellow-500 bg-opacity-20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),(0,r.jsx)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted text-sm",children:"Verified"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-500",children:t.filter(e=>"verified"===e.status).length})]}),(0,r.jsx)("div",{className:"w-12 h-12 bg-green-500 bg-opacity-20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),(0,r.jsx)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted text-sm",children:"Rejected"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-500",children:t.filter(e=>"rejected"===e.status).length})]}),(0,r.jsx)("div",{className:"w-12 h-12 bg-red-500 bg-opacity-20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),(0,r.jsx)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("label",{className:"text-white font-medium",children:"Filter by Status:"}),(0,r.jsxs)("select",{value:j,onChange:e=>b(e.target.value),className:"bg-darkmode border border-section border-opacity-30 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-primary",children:[(0,r.jsx)("option",{value:"all",children:"All Statuses"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"verified",children:"Verified"}),(0,r.jsx)("option",{value:"rejected",children:"Rejected"})]})]})}),(0,r.jsxs)("div",{className:"bg-section bg-opacity-10 border border-section border-opacity-20 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-section bg-opacity-20",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"User"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Document Type"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Submitted"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-section divide-opacity-20",children:T.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-section hover:bg-opacity-5 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-white font-medium",children:e.user_name}),(0,r.jsx)("div",{className:"text-muted text-sm",children:e.user_email})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-white",children:null===(t=e.document_type)||void 0===t?void 0:t.replace("_"," ").toUpperCase()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium gap-1 ".concat(C(e.status)),children:[S(e.status),e.status.toUpperCase()]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-muted",children:new Date(e.submitted_at).toLocaleDateString()}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:[e.document_file_url&&(0,r.jsx)("a",{href:e.document_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-white transition-colors",children:"View Document"}),"pending"===e.status&&(0,r.jsx)("button",{onClick:()=>N(e),className:"text-yellow-500 hover:text-white transition-colors ml-4",children:"Review"})]})]},e.id)})})]})}),0===T.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-section bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsx)("h3",{className:"text-white text-lg font-medium mb-2",children:"No submissions found"}),(0,r.jsx)("p",{className:"text-muted",children:"No KYC submissions match the current filter."})]})]})]}),w&&m&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-darkmode border border-section border-opacity-20 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:"Review KYC Submission"}),(0,r.jsx)("button",{onClick:()=>g(!1),className:"text-muted hover:text-white",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-white font-medium mb-2",children:"User"}),(0,r.jsxs)("p",{className:"text-muted",children:[m.user_name," (",m.user_email,")"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-white font-medium mb-2",children:"Document Type"}),(0,r.jsx)("p",{className:"text-muted",children:null===(e=m.document_type)||void 0===e?void 0:e.replace("_"," ").toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-white font-medium mb-2",children:"Current Status"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium gap-1 ".concat(C(m.status)),children:[S(m.status),m.status.toUpperCase()]})]}),m.document_file_url&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-white font-medium mb-2",children:"Document"}),(0,r.jsx)("a",{href:m.document_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-white transition-colors",children:"View Submitted Document →"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-white font-medium mb-2",children:"Admin Notes"}),(0,r.jsx)("textarea",{value:p,onChange:e=>f(e.target.value),placeholder:"Add notes about this verification...",className:"w-full bg-section bg-opacity-20 border border-section border-opacity-30 rounded-lg px-4 py-3 text-white placeholder-muted focus:outline-none focus:border-primary resize-none",rows:4})]})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:()=>k(m.id,"approve"),disabled:h===m.id,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:h===m.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:"Processing..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{children:"Approve"})]})}),(0,r.jsx)("button",{onClick:()=>k(m.id,"reject"),disabled:h===m.id,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:h===m.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:"Processing..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,r.jsx)("span",{children:"Reject"})]})})]})]})})})]})}},9636:function(e,t,s){"use strict";s.d(t,{CT:function(){return r}});let r="".concat("https://www.qfsvaultledger.org","/api");class a{handleApiError(e,t){let s="An unexpected error occurred";throw t.error?s=t.error:t.message?s=t.message:t.detail?s=t.detail:400===e.status?s="Invalid request. Please check your input.":401===e.status?s="Invalid credentials. Please check your email and password.":403===e.status?s="Access denied. Your account may be disabled.":404===e.status?s="User not found. Please check your email or sign up.":409===e.status?s="Email already exists. Please use a different email.":e.status>=500&&(s="Server error. Please try again later."),Error(s)}async register(e){try{let t=await fetch("".concat(r,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),s=await t.json();return t.ok||this.handleApiError(t,s),this.storeTokens(s.tokens),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async login(e){try{let t=await fetch("".concat(r,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),s=await t.json();return t.ok||this.handleApiError(t,s),this.storeTokens(s.tokens),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async getProfile(){let e=await this.authenticatedRequest("".concat(r,"/auth/profile/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get user profile");return t.user}storeTokens(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh)}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}isAuthenticated(){return!!this.getAccessToken()}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token found");let t=await fetch("".concat(r,"/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),s=await t.json();if(!t.ok)throw Error("Failed to refresh token");return localStorage.setItem("access_token",s.access),s.access}async authenticatedRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getAccessToken();if(!s)throw Error("No access token found");let r={Authorization:"Bearer ".concat(s),...t.headers};t.body instanceof FormData||(r["Content-Type"]="application/json");let a=await fetch(e,{...t,headers:r});if(401===a.status)try{s=await this.refreshToken();let r={Authorization:"Bearer ".concat(s),...t.headers};t.body instanceof FormData||(r["Content-Type"]="application/json"),a=await fetch(e,{...t,headers:r})}catch(e){console.warn("Token refresh failed, but keeping user logged in:",e)}return a}async changePassword(e){let t=await this.authenticatedRequest("".concat(r,"/auth/change-password/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:e.currentPassword,new_password:e.newPassword})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to change password");return s}async submitKYCDocument(e){let t=await this.authenticatedRequest("".concat(r,"/kyc/submit/"),{method:"POST",body:e}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to submit document");return s}async getKYCStatus(){let e=await this.authenticatedRequest("".concat(r,"/kyc/status/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC status");return t}async getAdminKYCList(){let e=await this.authenticatedRequest("".concat(r,"/admin/kyc/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC submissions");return t}async requestPasswordReset(e){try{let t=await fetch("".concat(r,"/auth/forgot-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({email:e})}),s=await t.json();return t.ok||this.handleApiError(t,s),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async resetPassword(e,t){try{let s=await fetch("".concat(r,"/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({token:e,password:t})}),a=await s.json();return s.ok||this.handleApiError(s,a),a}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async reviewKYCSubmission(e,t,s){let a=await this.authenticatedRequest("".concat(r,"/admin/kyc/").concat(e,"/review/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,notes:s})}),i=await a.json();if(!a.ok)throw Error(i.error||"Failed to review KYC submission");return i}getApiBaseUrl(){return r}}let i=new a;t.ZP=i}},function(e){e.O(0,[972,279,971,117,744],function(){return e(e.s=8742)}),_N_E=e.O()}]);