(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{1646:function(e,t,s){Promise.resolve().then(s.bind(s,5132))},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5132:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),r=s(2265),n=s(438),i=s(9636);function o(){let[e,t]=(0,r.useState)([]),[s,o]=(0,r.useState)(null),[c,l]=(0,r.useState)(""),[d,h]=(0,r.useState)(!0),[u,m]=(0,r.useState)("all");(0,r.useEffect)(()=>{p()},[]);let p=async()=>{try{h(!0);let e=localStorage.getItem("access_token"),s=await fetch("".concat(i.CT,"/support/admin/tickets/"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();t(e.tickets||[])}else t([{id:1,ticket_id:"ST-00001",department:"technical",subject:"Login Issues",message:"I am having trouble logging into my account. The password reset is not working.",status:"open",created_at:"2025-09-18T10:30:00Z",user:{id:1,username:"john_doe",email:"john@example.com"},replies:[]},{id:2,ticket_id:"ST-00002",department:"billing",subject:"Transaction Failed",message:"My transaction failed but money was deducted from my account.",status:"in_progress",created_at:"2025-09-18T09:15:00Z",user:{id:2,username:"jane_smith",email:"jane@example.com"},replies:[{id:1,message:"We are looking into this issue. Please provide your transaction ID.",is_admin_reply:!0,created_at:"2025-09-18T11:00:00Z",created_by:{username:"admin",email:"admin@qfs.com"}}]}])}catch(e){console.error("Failed to fetch support tickets:",e),t([{id:1,ticket_id:"ST-00001",department:"technical",subject:"Login Issues",message:"Login issues need resolution",status:"open",created_at:"2025-09-18T10:30:00Z",user:{id:1,username:"john_doe",email:"john@example.com"},replies:[]}])}finally{h(!1)}},x=async()=>{if(s&&c.trim())try{let e=localStorage.getItem("access_token"),a=await fetch("".concat(i.CT,"/support/admin/reply/"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({ticket_id:s.id,message:c.trim()})});if(a.ok){let e=(await a.json()).reply||{id:Date.now(),message:c,is_admin_reply:!0,created_at:new Date().toISOString(),created_by:{username:"admin",email:"admin@qfs.com"}},r={...s,replies:[...s.replies,e],status:"in_progress"};t(e=>e.map(e=>e.id===s.id?r:e)),o(r),l(""),console.log("Reply sent successfully")}else{console.error("Failed to send reply");let e={id:Date.now(),message:c,is_admin_reply:!0,created_at:new Date().toISOString(),created_by:{username:"admin",email:"admin@qfs.com"}},a={...s,replies:[...s.replies,e],status:"in_progress"};t(e=>e.map(e=>e.id===s.id?a:e)),o(a),l("")}}catch(r){console.error("Failed to send reply:",r);let e={id:Date.now(),message:c,is_admin_reply:!0,created_at:new Date().toISOString(),created_by:{username:"admin",email:"admin@qfs.com"}},a={...s,replies:[...s.replies,e],status:"in_progress"};t(e=>e.map(e=>e.id===s.id?a:e)),o(a),l("")}},g=async(e,a)=>{try{let r=localStorage.getItem("access_token"),n=await fetch("".concat(i.CT,"/support/admin/tickets/").concat(e,"/status/"),{method:"PUT",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({status:a})});t(t=>t.map(t=>t.id===e?{...t,status:a}:t)),s&&s.id===e&&o(e=>e?{...e,status:a}:null),n.ok?console.log("Ticket status updated to ".concat(a)):console.log("UI updated to ".concat(a," (API call failed but changes are shown)"))}catch(r){console.error("Failed to update ticket status:",r),t(t=>t.map(t=>t.id===e?{...t,status:a}:t)),s&&s.id===e&&o(e=>e?{...e,status:a}:null)}},f=e.filter(e=>"all"===u||e.status===u),j=e=>{switch(e){case"open":return"bg-red-100 text-red-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},y=e=>{switch(e){case"technical":return"bg-blue-100 text-blue-800";case"billing":return"bg-purple-100 text-purple-800";case"general":return"bg-green-100 text-green-800";case"compliance":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return d?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,a.jsx)(n.Z,{children:(0,a.jsx)("div",{className:"bg-gray-50 p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Support Tickets"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage and respond to user support requests"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"flex space-x-2",children:["all","open","in_progress","resolved","closed"].map(t=>(0,a.jsxs)("button",{onClick:()=>m(t),className:"px-4 py-2 rounded-lg capitalize ".concat(u===t?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:[t.replace("_"," ")," (",e.filter(e=>"all"===t||e.status===t).length,")"]},t))})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:["Tickets (",f.length,")"]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:f.map(e=>(0,a.jsxs)("div",{onClick:()=>o(e),className:"p-4 border-b cursor-pointer hover:bg-gray-50 ".concat((null==s?void 0:s.id)===e.id?"bg-blue-50 border-blue-200":""),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-blue-600",children:e.ticket_id}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(j(e.status)),children:e.status.replace("_"," ")})]}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.subject}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(y(e.department)),children:e.department}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["From: ",e.user.username]})]},e.id))})]})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:s?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:s.subject}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Ticket ID: ",s.ticket_id]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat(j(s.status)),children:s.status.replace("_"," ")}),(0,a.jsxs)("select",{value:s.status,onChange:e=>g(s.id,e.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"open",children:"Open"}),(0,a.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,a.jsx)("option",{value:"resolved",children:"Resolved"}),(0,a.jsx)("option",{value:"closed",children:"Closed"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Department:"}),(0,a.jsx)("span",{className:"ml-2 px-2 py-1 rounded-full text-xs ".concat(y(s.department)),children:s.department})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Created:"}),(0,a.jsx)("span",{className:"ml-2",children:new Date(s.created_at).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"User:"}),(0,a.jsxs)("span",{className:"ml-2",children:[s.user.username," (",s.user.email,")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Replies:"}),(0,a.jsx)("span",{className:"ml-2",children:s.replies.length})]})]})]}),(0,a.jsxs)("div",{className:"p-6 border-b bg-gray-50",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Original Message"}),(0,a.jsx)("p",{className:"text-gray-700",children:s.message})]}),(0,a.jsxs)("div",{className:"p-6 max-h-64 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Conversation"}),0===s.replies.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No replies yet"}):(0,a.jsx)("div",{className:"space-y-4",children:s.replies.map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg ".concat(e.is_admin_reply?"bg-blue-50 border-l-4 border-blue-500 ml-8":"bg-gray-50 border-l-4 border-gray-300 mr-8"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm",children:e.is_admin_reply?"Admin":s.user.username}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.message})]},e.id))})]}),(0,a.jsxs)("div",{className:"p-6 border-t",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Send Reply"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("textarea",{value:c,onChange:e=>l(e.target.value),placeholder:"Type your reply here...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[c.length,"/1000 characters"]}),(0,a.jsx)("button",{onClick:x,disabled:!c.trim(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Reply"})]})]})]})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-4",children:(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Ticket Selected"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Select a ticket from the list to view details and respond"})]})})]})]})})})}},438:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a=s(7437),r=s(2265),n=s(7648),i=s(9376);function o(e){let{children:t}=e,[s,o]=(0,r.useState)(!1),c=(0,i.usePathname)(),l=[{name:"Dashboard",href:"/admin",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6a2 2 0 01-2 2H10a2 2 0 01-2-2V5zM8 17v2a2 2 0 002 2h4a2 2 0 002-2v-2m-6 0h6"})]})},{name:"Support Tickets",href:"/admin/support",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{name:"Users",href:"/admin/users",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})},{name:"Transactions",href:"/admin/transactions",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})},{name:"Settings",href:"/admin/settings",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[s&&(0,a.jsx)("div",{className:"fixed inset-0 z-40 lg:hidden",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>o(!1)})}),(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 ".concat(s?"translate-x-0":"-translate-x-full"),children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-16 bg-blue-600 text-white",children:(0,a.jsx)("h1",{className:"text-xl font-bold",children:"QFS Admin"})}),(0,a.jsx)("nav",{className:"mt-8",children:(0,a.jsx)("div",{className:"px-4 space-y-2",children:l.map(e=>{let t=c===e.href;return(0,a.jsxs)(n.default,{href:e.href,className:"group flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(t?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),children:[(0,a.jsx)("span",{className:"mr-3 ".concat(t?"text-blue-600":"text-gray-400 group-hover:text-gray-500"),children:e.icon}),e.name]},e.name)})})}),(0,a.jsx)("div",{className:"absolute bottom-0 w-full p-4 border-t",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"A"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Admin User"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"admin@qfs.com"})]})]})})]}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsx)("div",{className:"sticky top-0 z-30 bg-white shadow-sm border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-4",children:[(0,a.jsx)("button",{onClick:()=>o(!s),className:"text-gray-500 hover:text-gray-600 lg:hidden",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{className:"relative p-2 text-gray-400 hover:text-gray-500",children:[(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-3.5-3.5a50.002 50.002 0 00-7-7L15 17zM18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636"})}),(0,a.jsx)("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-400 ring-2 ring-white"})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("button",{className:"flex items-center text-sm text-gray-500 hover:text-gray-700",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"A"})}),(0,a.jsx)("svg",{className:"ml-2 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})]})}),(0,a.jsx)("main",{className:"flex-1",children:t})]})]})}},9636:function(e,t,s){"use strict";s.d(t,{CT:function(){return a}});let a="".concat("https://www.qfsvaultledger.org","/api");class r{handleApiError(e,t){let s="An unexpected error occurred";throw t.error?s=t.error:t.message?s=t.message:t.detail?s=t.detail:400===e.status?s="Invalid request. Please check your input.":401===e.status?s="Invalid credentials. Please check your email and password.":403===e.status?s="Access denied. Your account may be disabled.":404===e.status?s="User not found. Please check your email or sign up.":409===e.status?s="Email already exists. Please use a different email.":e.status>=500&&(s="Server error. Please try again later."),Error(s)}async register(e){try{let t=await fetch("".concat(a,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),s=await t.json();return t.ok||this.handleApiError(t,s),this.storeTokens(s.tokens),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async login(e){try{let t=await fetch("".concat(a,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),s=await t.json();return t.ok||this.handleApiError(t,s),this.storeTokens(s.tokens),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async getProfile(){let e=await this.authenticatedRequest("".concat(a,"/auth/profile/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get user profile");return t.user}storeTokens(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh)}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}isAuthenticated(){return!!this.getAccessToken()}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token found");let t=await fetch("".concat(a,"/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),s=await t.json();if(!t.ok)throw Error("Failed to refresh token");return localStorage.setItem("access_token",s.access),s.access}async authenticatedRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getAccessToken();if(!s)throw Error("No access token found");let a={Authorization:"Bearer ".concat(s),...t.headers};t.body instanceof FormData||(a["Content-Type"]="application/json");let r=await fetch(e,{...t,headers:a});if(401===r.status)try{s=await this.refreshToken();let a={Authorization:"Bearer ".concat(s),...t.headers};t.body instanceof FormData||(a["Content-Type"]="application/json"),r=await fetch(e,{...t,headers:a})}catch(e){console.warn("Token refresh failed, but keeping user logged in:",e)}return r}async changePassword(e){let t=await this.authenticatedRequest("".concat(a,"/auth/change-password/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:e.currentPassword,new_password:e.newPassword})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to change password");return s}async submitKYCDocument(e){let t=await this.authenticatedRequest("".concat(a,"/kyc/submit/"),{method:"POST",body:e}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to submit document");return s}async getKYCStatus(){let e=await this.authenticatedRequest("".concat(a,"/kyc/status/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC status");return t}async getAdminKYCList(){let e=await this.authenticatedRequest("".concat(a,"/admin/kyc/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC submissions");return t}async requestPasswordReset(e){try{let t=await fetch("".concat(a,"/auth/forgot-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({email:e})}),s=await t.json();return t.ok||this.handleApiError(t,s),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async resetPassword(e,t){try{let s=await fetch("".concat(a,"/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({token:e,password:t})}),r=await s.json();return s.ok||this.handleApiError(s,r),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async reviewKYCSubmission(e,t,s){let r=await this.authenticatedRequest("".concat(a,"/admin/kyc/").concat(e,"/review/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,notes:s})}),n=await r.json();if(!r.ok)throw Error(n.error||"Failed to review KYC submission");return n}getApiBaseUrl(){return a}}let n=new r;t.ZP=n}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=1646)}),_N_E=e.O()}]);