"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[726],{4726:function(e,r,t){t.d(r,{default:function(){return m}});var a=t(7437),s=t(7648),o=t(9376),n=t(2265),i=t(9064),d=t(7208),c=t(9663),l=t(9636),u=t(9646),h=e=>{let{onClose:r,onBackToSignIn:t}=e,[o,c]=(0,n.useState)(""),[h,m]=(0,n.useState)(!1),[p,w]=(0,n.useState)(!1),[b,x]=(0,n.useState)(""),g=async e=>{e.preventDefault(),x(""),m(!0);try{let e=await l.ZP.requestPasswordReset(o);w(!0),i.ZP.success(e.message||"Password reset email sent successfully!")}catch(r){let e=r.message||"Failed to send reset email";x(e),i.ZP.error(e)}finally{m(!1)}},y=()=>{w(!1),x(""),c(""),t()},f=async()=>{x(""),m(!0);try{let e=await l.ZP.requestPasswordReset(o);i.ZP.success(e.message||"Reset email sent again!")}catch(r){let e=r.message||"Failed to resend email";x(e),i.ZP.error(e)}finally{m(!1)}};return p?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-10 text-center mx-auto inline-block max-w-[160px]",children:(0,a.jsx)(d.Z,{})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(u.Icon,{icon:"mdi:email-check",className:"text-primary text-64 mx-auto"})}),(0,a.jsx)("h3",{className:"text-white text-24 font-medium mb-4",children:"Check Your Email"}),(0,a.jsxs)("p",{className:"text-muted text-opacity-60 text-16 mb-6",children:["We've sent a password reset link to ",(0,a.jsx)("strong",{className:"text-white",children:o})]}),(0,a.jsx)("p",{className:"text-muted text-opacity-60 text-14 mb-8",children:"Didn't receive the email? Check your spam folder or try again."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("button",{onClick:f,disabled:h,className:"w-full bg-transparent border border-primary text-primary hover:bg-primary hover:text-darkmode py-3 rounded-lg text-18 font-medium transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Sending...":"Resend Email"}),(0,a.jsx)("button",{onClick:y,className:"text-primary hover:underline bg-transparent border-none cursor-pointer text-16",children:"← Back to Sign In"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-10 text-center mx-auto inline-block max-w-[160px]",children:(0,a.jsx)(d.Z,{})}),(0,a.jsx)("h3",{className:"text-white text-24 font-medium text-center mb-6",children:"Forgot Password?"}),(0,a.jsx)("p",{className:"text-muted text-opacity-60 text-16 text-center mb-8",children:"Enter your email address and we'll send you a link to reset your password."}),b&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-500 bg-opacity-20 border border-red-500 rounded-lg",children:(0,a.jsx)("p",{className:"text-red-400 text-14",children:b})}),(0,a.jsxs)("form",{onSubmit:g,children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-white text-16 mb-2",children:"Email Address"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"Enter your email",value:o,onChange:e=>c(e.target.value),required:!0,className:"w-full rounded-md border border-dark_border border-opacity-60 border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus:border-primary focus-visible:shadow-none text-white dark:focus:border-primary"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("button",{type:"submit",disabled:h,className:"bg-primary w-full py-3 rounded-lg text-18 font-medium border border-primary hover:text-primary hover:bg-transparent disabled:opacity-50 disabled:cursor-not-allowed transition duration-300",children:h?"Sending...":"Send Reset Link"})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{onClick:y,className:"text-primary hover:underline bg-transparent border-none cursor-pointer text-16",children:"← Back to Sign In"})}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-muted text-opacity-60 text-14",children:["Remember your password?"," ",(0,a.jsx)(s.default,{href:"/",className:"text-primary hover:underline",children:"Go to Homepage"})]})})]})},m=e=>{let{onClose:r,onSwitchToSignUp:t}=e,u=(0,o.useRouter)(),[m,p]=(0,n.useState)(!1),[w,b]=(0,n.useState)({email:"",password:"",general:""}),[x,g]=(0,n.useState)({email:"",password:"",checkboxToggle:!1}),[y,f]=(0,n.useState)(!1),k=e=>e.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"":"Please enter a valid email address":"Email is required",j=e=>e.trim()?e.length<6?"Password must be at least 6 characters":"":"Password is required",N=()=>{let e={email:k(x.email),password:j(x.password),general:""};return b(e),!e.email&&!e.password},v=async e=>{if(e.preventDefault(),b({email:"",password:"",general:""}),N()){f(!0);try{await l.ZP.login({email:x.email,password:x.password}),i.ZP.success("Login successful! Redirecting to dashboard..."),f(!1),r&&r(),setTimeout(()=>{u.push("/dashboard")},1e3)}catch(r){f(!1);let e=r.message||"Login failed";e.toLowerCase().includes("invalid credentials")||e.toLowerCase().includes("wrong password")||e.toLowerCase().includes("incorrect password")?b(e=>({...e,general:"Invalid email or password. Please check your credentials and try again."})):e.toLowerCase().includes("user not found")||e.toLowerCase().includes("user does not exist")?b(e=>({...e,general:"No account found with this email address. Please check your email or sign up."})):e.toLowerCase().includes("account disabled")||e.toLowerCase().includes("account suspended")?b(e=>({...e,general:"Your account has been disabled. Please contact support."})):e.toLowerCase().includes("network")||e.toLowerCase().includes("connection")?b(e=>({...e,general:"Network error. Please check your connection and try again."})):b(r=>({...r,general:e})),i.ZP.error(e)}}};return m?(0,a.jsx)(h,{onClose:r||(()=>{}),onBackToSignIn:()=>p(!1)}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-10 text-center mx-auto inline-block max-w-[160px]",children:(0,a.jsx)(d.Z,{})}),(0,a.jsxs)("form",{onSubmit:v,children:[w.general&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-md bg-red-500 bg-opacity-10 border border-red-500 border-opacity-30",children:(0,a.jsx)("p",{className:"text-red-400 text-sm",children:w.general})}),(0,a.jsxs)("div",{className:"mb-[22px]",children:[(0,a.jsx)("input",{type:"email",placeholder:"Email",value:x.email,onChange:e=>{g({...x,email:e.target.value}),w.email&&b(e=>({...e,email:""}))},className:"w-full rounded-md border ".concat(w.email?"border-red-500 focus:border-red-500":"border-dark_border border-opacity-60 focus:border-primary"," border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus-visible:shadow-none text-white dark:focus:border-primary")}),w.email&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:w.email})]}),(0,a.jsxs)("div",{className:"mb-[22px]",children:[(0,a.jsx)("input",{type:"password",placeholder:"Password",value:x.password,onChange:e=>{g({...x,password:e.target.value}),w.password&&b(e=>({...e,password:""}))},className:"w-full rounded-md border ".concat(w.password?"border-red-500 focus:border-red-500":"border-dark_border border-opacity-60 focus:border-primary"," border-solid bg-transparent px-5 py-3 text-base text-dark outline-none transition placeholder:text-grey focus-visible:shadow-none text-white dark:focus:border-primary")}),w.password&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:w.password})]}),(0,a.jsx)("div",{className:"mb-9",children:(0,a.jsxs)("button",{type:"submit",disabled:y||!x.email||!x.password,className:"bg-primary w-full py-3 rounded-lg text-18 font-medium border border-primary hover:text-primary hover:bg-transparent disabled:opacity-50 disabled:cursor-not-allowed",children:["Sign In ",y&&(0,a.jsx)(c.Z,{})]})})]}),(0,a.jsx)("button",{onClick:()=>p(!0),className:"mb-2 inline-block text-base text-dark hover:text-primary text-white dark:hover:text-primary bg-transparent border-none cursor-pointer",children:"Forgot Password?"}),(0,a.jsxs)("p",{className:"text-body-secondary text-white text-base",children:["Not a member yet?"," ",t?(0,a.jsx)("button",{onClick:t,className:"text-primary hover:underline bg-transparent border-none cursor-pointer",children:"Sign Up"}):(0,a.jsx)(s.default,{href:"/",className:"text-primary hover:underline",children:"Sign Up"})]})]})}},9663:function(e,r,t){var a=t(7437);t(2265),r.Z=()=>(0,a.jsx)("span",{className:"ml-1.5 h-4 w-4 animate-spin rounded-full border-2 border-solid border-white border-t-transparent dark:border-t-transparent"})},7208:function(e,r,t){var a=t(7437),s=t(3950),o=t(3145),n=t(7648);r.Z=()=>(0,a.jsx)(n.default,{href:"/",children:(0,a.jsx)(o.default,{src:"".concat((0,s.p)(),"images/logo/logo.png"),alt:"QFS Ledger Logo",width:160,height:50,style:{width:"auto",height:"auto",maxHeight:"50px",objectFit:"contain"},quality:100,priority:!0})})},9636:function(e,r,t){t.d(r,{CT:function(){return a}});let a="".concat("https://www.qfsvaultledger.org","/api");class s{handleApiError(e,r){let t="An unexpected error occurred";throw r.error?t=r.error:r.message?t=r.message:r.detail?t=r.detail:400===e.status?t="Invalid request. Please check your input.":401===e.status?t="Invalid credentials. Please check your email and password.":403===e.status?t="Access denied. Your account may be disabled.":404===e.status?t="User not found. Please check your email or sign up.":409===e.status?t="Email already exists. Please use a different email.":e.status>=500&&(t="Server error. Please try again later."),Error(t)}async register(e){try{let r=await fetch("".concat(a,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),t=await r.json();return r.ok||this.handleApiError(r,t),this.storeTokens(t.tokens),t}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async login(e){try{let r=await fetch("".concat(a,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),t=await r.json();return r.ok||this.handleApiError(r,t),this.storeTokens(t.tokens),t}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async getProfile(){let e=await this.authenticatedRequest("".concat(a,"/auth/profile/")),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to get user profile");return r.user}storeTokens(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh)}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}isAuthenticated(){return!!this.getAccessToken()}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token found");let r=await fetch("".concat(a,"/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),t=await r.json();if(!r.ok)throw Error("Failed to refresh token");return localStorage.setItem("access_token",t.access),t.access}async authenticatedRequest(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this.getAccessToken();if(!t)throw Error("No access token found");let a={Authorization:"Bearer ".concat(t),...r.headers};r.body instanceof FormData||(a["Content-Type"]="application/json");let s=await fetch(e,{...r,headers:a});if(401===s.status)try{t=await this.refreshToken();let a={Authorization:"Bearer ".concat(t),...r.headers};r.body instanceof FormData||(a["Content-Type"]="application/json"),s=await fetch(e,{...r,headers:a})}catch(e){console.warn("Token refresh failed, but keeping user logged in:",e)}return s}async changePassword(e){let r=await this.authenticatedRequest("".concat(a,"/auth/change-password/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:e.currentPassword,new_password:e.newPassword})}),t=await r.json();if(!r.ok)throw Error(t.error||"Failed to change password");return t}async submitKYCDocument(e){let r=await this.authenticatedRequest("".concat(a,"/kyc/submit/"),{method:"POST",body:e}),t=await r.json();if(!r.ok)throw Error(t.error||"Failed to submit document");return t}async getKYCStatus(){let e=await this.authenticatedRequest("".concat(a,"/kyc/status/")),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to get KYC status");return r}async getAdminKYCList(){let e=await this.authenticatedRequest("".concat(a,"/admin/kyc/")),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to get KYC submissions");return r}async requestPasswordReset(e){try{let r=await fetch("".concat(a,"/auth/forgot-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({email:e})}),t=await r.json();return r.ok||this.handleApiError(r,t),t}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async resetPassword(e,r){try{let t=await fetch("".concat(a,"/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({token:e,password:r})}),s=await t.json();return t.ok||this.handleApiError(t,s),s}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async reviewKYCSubmission(e,r,t){let s=await this.authenticatedRequest("".concat(a,"/admin/kyc/").concat(e,"/review/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:r,notes:t})}),o=await s.json();if(!s.ok)throw Error(o.error||"Failed to review KYC submission");return o}getApiBaseUrl(){return a}}let o=new s;r.ZP=o},3950:function(e,r,t){t.d(r,{p:function(){return a}});let a=()=>""}}]);