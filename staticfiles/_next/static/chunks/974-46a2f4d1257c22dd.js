"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5974:function(e,t,r){var s=r(7437),o=r(2265),a=r(9376),n=r(7648),i=r(9636),c=r(9064);t.Z=e=>{var t;let{children:r}=e,[l,d]=(0,o.useState)(null),[h,u]=(0,o.useState)(!0),m=(0,a.useRouter)();return((0,o.useEffect)(()=>{(async()=>{try{if(!i.Z.isAuthenticated()){m.push("/");return}let e=await i.Z.getProfile();d(e)}catch(e){console.error("Authentication check failed:",e),c.ZP.error("Failed to load user profile. Please try refreshing the page.")}finally{u(!1)}})()},[m]),h)?(0,s.jsx)("div",{className:"min-h-screen bg-darkmode flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Loading..."})}):l?(0,s.jsxs)("div",{className:"min-h-screen bg-darkmode flex flex-col",children:[(0,s.jsx)("nav",{className:"bg-section bg-opacity-20 border-b border-section border-opacity-20 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)(n.default,{href:"/dashboard",className:"text-xl font-bold text-white hover:text-primary transition-colors",children:["QFS ",(0,s.jsx)("span",{className:"text-green-500",children:"Vault Ledger"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[((null==l?void 0:l.email)==="admin@example.com"||(null==l?void 0:l.email)==="admin@admin.com"||(null==l?void 0:l.email)==="admin@qfsvaultledger.org")&&(0,s.jsxs)(n.default,{href:"/admin/kyc",className:"text-primary hover:text-white transition-colors flex items-center gap-2 px-3 py-1 border border-primary rounded-md hover:bg-primary hover:text-darkmode",children:[(0,s.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Admin"]}),(0,s.jsxs)("button",{onClick:()=>m.push("/notifications"),className:"relative hover:scale-105 transition-transform",children:[(0,s.jsxs)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-primary transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.73 21a2 2 0 01-3.46 0"})]}),(0,s.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:"2"})]}),(0,s.jsx)(n.default,{href:"/profile",className:"w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors cursor-pointer",children:(0,s.jsx)("span",{className:"text-darkmode font-semibold text-sm",children:null==l?void 0:null===(t=l.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})})]})]})}),(0,s.jsx)("main",{className:"flex-1",children:r}),(0,s.jsx)("footer",{className:"fixed bottom-0 left-0 right-0 bg-section bg-opacity-20 border-t border-section border-opacity-20 px-6 py-4 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"flex justify-around md:justify-between items-center max-w-md md:max-w-full mx-auto md:mx-6",children:[(0,s.jsxs)(n.default,{href:"/profile",className:"flex flex-col items-center gap-1 text-muted hover:text-white transition-colors",children:[(0,s.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,s.jsx)("span",{className:"text-xs",children:"Settings"})]}),(0,s.jsxs)("button",{onClick:()=>m.push("/notifications"),className:"flex flex-col items-center gap-1 text-muted hover:text-white transition-colors",children:[(0,s.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.73 21a2 2 0 01-3.46 0"})]}),(0,s.jsx)("span",{className:"text-xs",children:"Notifications"})]}),(0,s.jsxs)(n.default,{href:"/dashboard",className:"flex flex-col items-center gap-1 text-muted hover:text-white transition-colors",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),(0,s.jsx)("span",{className:"text-xs",children:"Wallet"})]}),(0,s.jsxs)("button",{onClick:()=>m.push("/support"),className:"flex flex-col items-center gap-1 text-muted hover:text-white transition-colors",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{className:"text-xs",children:"Support"})]}),(0,s.jsxs)("button",{onClick:()=>{i.Z.logout(),c.ZP.success("Logged out successfully"),m.push("/")},className:"flex flex-col items-center gap-1 text-muted hover:text-red-400 transition-colors",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,s.jsx)("span",{className:"text-xs",children:"Logout"})]})]})})]}):null}},9636:function(e,t,r){let s="".concat("https://www.qfsvaultledger.org","/api");class o{handleApiError(e,t){let r="An unexpected error occurred";throw t.error?r=t.error:t.message?r=t.message:t.detail?r=t.detail:400===e.status?r="Invalid request. Please check your input.":401===e.status?r="Invalid credentials. Please check your email and password.":403===e.status?r="Access denied. Your account may be disabled.":404===e.status?r="User not found. Please check your email or sign up.":409===e.status?r="Email already exists. Please use a different email.":e.status>=500&&(r="Server error. Please try again later."),Error(r)}async register(e){try{let t=await fetch("".concat(s,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),r=await t.json();return t.ok||this.handleApiError(t,r),this.storeTokens(r.tokens),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async login(e){try{let t=await fetch("".concat(s,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(e)}),r=await t.json();return t.ok||this.handleApiError(t,r),this.storeTokens(r.tokens),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async getProfile(){let e=await this.authenticatedRequest("".concat(s,"/auth/profile/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get user profile");return t.user}storeTokens(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh)}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}isAuthenticated(){return!!this.getAccessToken()}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token found");let t=await fetch("".concat(s,"/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),r=await t.json();if(!t.ok)throw Error("Failed to refresh token");return localStorage.setItem("access_token",r.access),r.access}async authenticatedRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getAccessToken();if(!r)throw Error("No access token found");let s={Authorization:"Bearer ".concat(r),...t.headers};t.body instanceof FormData||(s["Content-Type"]="application/json");let o=await fetch(e,{...t,headers:s});if(401===o.status)try{r=await this.refreshToken();let s={Authorization:"Bearer ".concat(r),...t.headers};t.body instanceof FormData||(s["Content-Type"]="application/json"),o=await fetch(e,{...t,headers:s})}catch(e){console.warn("Token refresh failed, but keeping user logged in:",e)}return o}async changePassword(e){let t=await this.authenticatedRequest("".concat(s,"/auth/change-password/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:e.currentPassword,new_password:e.newPassword})}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to change password");return r}async submitKYCDocument(e){let t=await this.authenticatedRequest("".concat(s,"/kyc/submit/"),{method:"POST",body:e}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to submit document");return r}async getKYCStatus(){let e=await this.authenticatedRequest("".concat(s,"/kyc/status/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC status");return t}async getAdminKYCList(){let e=await this.authenticatedRequest("".concat(s,"/admin/kyc/")),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to get KYC submissions");return t}async requestPasswordReset(e){try{let t=await fetch("".concat(s,"/auth/forgot-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({email:e})}),r=await t.json();return t.ok||this.handleApiError(t,r),r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async resetPassword(e,t){try{let r=await fetch("".concat(s,"/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({token:e,password:t})}),o=await r.json();return r.ok||this.handleApiError(r,o),o}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw Error("Network error. Please check your connection and try again.");throw e}}async reviewKYCSubmission(e,t,r){let o=await this.authenticatedRequest("".concat(s,"/admin/kyc/").concat(e,"/review/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,notes:r})}),a=await o.json();if(!o.ok)throw Error(a.error||"Failed to review KYC submission");return a}}let a=new o;t.Z=a}}]);